apiVersion: v1
kind: Secret
metadata:
  name: portfolio-tls-secret
type: kubernetes.io/tls
data:
  tls.crt: "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZBakNDQStxZ0F3SUJBZ0lTQlcxN3A1TE1OSTI5QVMyWEJRcmhGekxGTUEwR0NTcUdTSWIzRFFFQkN3VUEKTURNeEN6QUpCZ05WQkFZVEFsVlRNUll3RkFZRFZRUUtFdzFNWlhRbmN5QkZibU55ZVhCME1Rd3dDZ1lEVlFRRApFd05TTVRNd0hoY05NalV4TURFek1EQXhOalF4V2hjTk1qWXdNVEV4TURBeE5qUXdXakFXTVJRd0VnWURWUVFECkV3dHNhV1J2WW1Wc0xtOTJhRENDQVNJd0RRWUpLb1pJaHZjTkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFMcGEKc3puTVpCL3NDdnZsNnAvcVdRS0J4dTdmQVVjYVJRZFlBS0Q4dVZBTjhyNnorUkxpdEI0NDQ4M3BTTWREcDROLwpqR0FzdGlEeUxjeG50eU5qb0RTaGRRWW84aDBuY1ltaWJuTU5MWERBZUdQWmhpdnpEaE9SNXlUNzZzbGFnRllOClE4dXJxTXRZR1B2SXA2M1hYdTZzbisyMmlleHZKQVo4QU9VRXdjUkVLd3hsZmE3NnJUQ2N6UzJjK01LM043UnYKWms2VytEdDZxUFE1WWdxemplenZ2VEIxbk91T0NUdFZjYWFKYmd3VUt3UGxLajU1bzdsTWZoWW5tZmQxNTJMVQpDNmdERkJTQWY5ZEJFTlpQbnNLWHpkeDFhMWwyRjdSSjRsdjVIN0w5MzBCSnlob0xBTkNkTDdwMlpweFlZWVFHClM0NXZUT0FlV1YybDVGSFA2RDhDQXdFQUFhT0NBaXN3Z2dJbk1BNEdBMVVkRHdFQi93UUVBd0lGb0RBZEJnTlYKSFNVRUZqQVVCZ2dyQmdFRkJRY0RBUVlJS3dZQkJRVUhBd0l3REFZRFZSMFRBUUgvQkFJd0FEQWRCZ05WSFE0RQpGZ1FVT2h5aXdDYlU1M29MS0h0Z2FXSnFyMktLYkRnd0h3WURWUjBqQkJnd0ZvQVU1NnVmRHl3em9GUFRYazk0CnlMS0VEanZXa2pNd013WUlLd1lCQlFVSEFRRUVKekFsTUNNR0NDc0dBUVVGQnpBQ2hoZG9kSFJ3T2k4dmNqRXoKTG1rdWJHVnVZM0l1YjNKbkx6QW5CZ05WSFJFRUlEQWVnZ3RzYVdSdlltVnNMbTkyYUlJUGQzZDNMbXhwWkc5aQpaV3d1YjNab01CTUdBMVVkSUFRTU1Bb3dDQVlHWjRFTUFRSUJNQzRHQTFVZEh3UW5NQ1V3STZBaG9CK0dIV2gwCmRIQTZMeTl5TVRNdVl5NXNaVzVqY2k1dmNtY3ZOekF1WTNKc01JSUJBd1lLS3dZQkJBSFdlUUlFQWdTQjlBU0IKOFFEdkFIVUFTWnliYWQ0ZGZPejhOdDdOaDJTbXVGdXZDb2VBR2RGVlV2dnA2eW5kK01NQUFBR1oyeUxBcWdBQQpCQU1BUmpCRUFpQSs4VXo2a2lpbHBMSnNFMXdSK3FXUVg3ZTRtMzNLL0NMRWs4V2pwenBXeUFJZ1BEcG5SK2dYCmJHY2c0bWFudXQ2ZHl6YjJYaXVweFIrY3grSS9NQmJKZ0Y0QWRnQU9WNVM4ODY2cFBqTWJMSmtIcy9lUTM1dkMKUFhFeUpkMGhxU1dzWWNWT0lRQUFBWm5iSXNDaEFBQUVBd0JITUVVQ0lRRE1MUHJJUFlxMHloTXJVWEt3VmZ2VQpHWWRvdEdwL0VXYkhxVFpiOTZ1dkF3SWdGNDFjWE9oU2NCdVhlRitEblNFbHphYlRTOEh4NkhQMjFERmRRRUpxCmRxOHdEUVlKS29aSWh2Y05BUUVMQlFBRGdnRUJBR1JNcFNOdjVtTnNtb0Y2MGxwaXZTUENiLzdUcHFFNThBL3EKTVJ0WVp3cXY5M1VIRTk5YURxN21pQlFpaVgwbnZUNEhlaXA1VGtUcXp2MENQQnVMY25uRWNyV1NtV0kzTE9ybgphbVBBbVA5ak5jNWtvRXdwYzlQbHRXc1U4U2JjaXJUL1kxYWFlaGk2NDgyYm83djFGQ3U4RDkzdW1YUWNTeVdlCmJaeVU4WGhxLzRXMEV1ejhGVlIvSFZCYnIzVHYvUU10YjlHVDdtbS9xdjlnaS9BWEM0ajBFY0ZwaHAxL3hrMTIKV0RQKy9zVytsS2tyM3JKZUxNL1h2VGRNcThhTkovUUhGdlF2eEhqeTBqbEtCM3dVNG1qcERXaTRWak8vR2x0VQpoWUtPM1gzU2cyK3p3M1FXTU5jcHhZSmFCWGRLVDFvMWI0SlR5cGE5MUhPWURpNjlhRWs9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUZCVENDQXUyZ0F3SUJBZ0lRV2dEeUV0alV0SUR6a2tGWDZpbURCVEFOQmdrcWhraUc5dzBCQVFzRkFEQlAKTVFzd0NRWURWUVFHRXdKVlV6RXBNQ2NHQTFVRUNoTWdTVzUwWlhKdVpYUWdVMlZqZFhKcGRIa2dVbVZ6WldGeQpZMmdnUjNKdmRYQXhGVEFUQmdOVkJBTVRERWxUVWtjZ1VtOXZkQ0JZTVRBZUZ3MHlOREF6TVRNd01EQXdNREJhCkZ3MHlOekF6TVRJeU16VTVOVGxhTURNeEN6QUpCZ05WQkFZVEFsVlRNUll3RkFZRFZRUUtFdzFNWlhRbmN5QkYKYm1OeWVYQjBNUXd3Q2dZRFZRUURFd05TTVRNd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFSwpBb0lCQVFDbFozQ04wRmFCWkJVWFljMjVCdFN0R1pDTUpsQTNtQlpqa2xUYjJjeUVCWlBzMCt3SUc2QmdVVU5JCmZTdkhTSmFldEMzYW5jZ25PMWVobjZ2dzFnN1VEakRLYjV1eDBkYWtuVEkrV0U0MWIwVllhSEVYL0Q3WVhZS2cKTDdKUmJMQWFYYmhaempWbHlJdWhyeEEzLytPY1hjSkpGelQvakN1TGpmQzhjU3lUREIwRnhMckh6YXJKWG56Ugp5UUgzbkFQMi9BcGQ5TnA3NXR0MlFuRHI5RTBpMmdCM2I5YkpYeGY5Mm5VdXBWY005dXBjdHVCenBXalBvWFRpCmRZSitFSi9COWFMckFlazRzUXBFek5QQ2lmVkpOWUlLTkxNYzZZakNSMDZDRGdvMjhFZFBpdkVwQkhYYXplR2EKWFA5ZW5aaVZ1cHBEMEVxaUZ3VUJCRERUTXJPUEFnTUJBQUdqZ2Znd2dmVXdEZ1lEVlIwUEFRSC9CQVFEQWdHRwpNQjBHQTFVZEpRUVdNQlFHQ0NzR0FRVUZCd01DQmdnckJnRUZCUWNEQVRBU0JnTlZIUk1CQWY4RUNEQUdBUUgvCkFnRUFNQjBHQTFVZERnUVdCQlRucTU4UExET2dVOU5lVDNqSXNvUU9POWFTTXpBZkJnTlZIU01FR0RBV2dCUjUKdEZubWU3Ymw1QUZ6Z0FpSXlCcFk5dW1iYmpBeUJnZ3JCZ0VGQlFjQkFRUW1NQ1F3SWdZSUt3WUJCUVVITUFLRwpGbWgwZEhBNkx5OTRNUzVwTG14bGJtTnlMbTl5Wnk4d0V3WURWUjBnQkF3d0NqQUlCZ1puZ1F3QkFnRXdKd1lEClZSMGZCQ0F3SGpBY29CcWdHSVlXYUhSMGNEb3ZMM2d4TG1NdWJHVnVZM0l1YjNKbkx6QU5CZ2txaGtpRzl3MEIKQVFzRkFBT0NBZ0VBVVRkWVVxRWltelc3VGJyT3lwTHFDZkw3Vk93WWYvUTc5T0g1Y0hMQ1plZ2dmUWhEY29ubAprN0tnaDhiMHZpKy9YdVd1N0NOOG4vVVBlZzF2bzNHK3RhWGlycnl0dGhRaW5BSEd3Yy9VZGJPeWdKYTl6dUJjClZ5cW9IM0NYVFhESW5UKzhhK2MzYUVWTUoyU3QrcFNuNGVkK1drRHA4aWpzaWp2RXlGd0U0N2h1bFcwTHR6amcKOWZPVjVQbXJnL3p4V2JSdUwrazBEQkRIRUplbm5Dc0FlbjdjMzVQbXg3anBtSi9IdGdSaGNuejB5alNCdnlJdwo2TDFRSXVwa0N2MlNCT0RUL3hERDNnZlFReUt2NnJvVjRHMkVoZkV5QXNXcG1vanhqQ1VDR2l5Zzk3RnZEdG0vCk5LMkxTYzlseWJLeEI3M0kyK1AyRzNDYVdwdnZwQWlIQ1Z1MzBqVzhHQ3hLZGZoc1h0bkl5Mmltc2tRcVZaMm0KMFBteG9iYjI4VHVjcjd4Qks3Q3R3dlByYjc5b3M3dTJYUDNPNWY5Yi9INjZHTnlScmdsUlhscllqSTFvR1lMLwpmNEkxbi9TZ3VzZGE2V3ZBNkMxOTBreGpVMTVZMTJtSFU0K0J4eVI5Y3gyaGhHUzlmQWpNWktKc3MyOHF4dno2CkF4dTRDYURtUk5acEsvcFFyWEYxN3lYQ1hrbUVXZ3ZTT0VaeTZaOXBjYkxJVkVHY2tWL2lWZXEwQU9vMnBrZzkKcDRRUkl5MHRLMmRpUkVOTFNGMkt5c0Z3Ylk2QjI2QkZlRnMzdjFzWVZSaEZXOW5Ma09yUVZwb3JDUzBLeVptZgp3VkQ4OXFTVGxuY3RMY1puSWF2aktzS1V1MW5BMWlVMHlZTWRZZXBLUjdsV2Jud2hkeDNld29rPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
  tls.key: "LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2d0lCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktrd2dnU2xBZ0VBQW9JQkFRQzZXck01ekdRZjdBcjcKNWVxZjZsa0NnY2J1M3dGSEdrVUhXQUNnL0xsUURmSytzL2tTNHJRZU9PUE42VWpIUTZlRGY0eGdMTFlnOGkzTQpaN2NqWTZBMG9YVUdLUElkSjNHSm9tNXpEUzF3d0hoajJZWXI4dzRUa2VjaysrckpXb0JXRFVQTHE2akxXQmo3CnlLZXQxMTd1ckovdHRvbnNieVFHZkFEbEJNSEVSQ3NNWlgydStxMHduTTB0blBqQ3R6ZTBiMlpPbHZnN2VxajAKT1dJS3M0M3M3NzB3ZFp6cmpnazdWWEdtaVc0TUZDc0Q1U28rZWFPNVRINFdKNW4zZGVkaTFBdW9BeFFVZ0gvWApRUkRXVDU3Q2w4M2NkV3RaZGhlMFNlSmIrUit5L2Q5QVNjb2FDd0RRblMrNmRtYWNXR0dFQmt1T2IwemdIbGxkCnBlUlJ6K2cvQWdNQkFBRUNnZ0VCQUlWWlFjYXFLenRzZksrajVqQm9VU2txRkYvNTA4QTlYQWZWUVIzeHVlay8KRWVURWhBYXZrcFBOd2JVbXFaMXRIQUZNMC9ZK0NGV3E5bnE5L0o2bU80MXR1MytjN1NOUGhqOG1yRUpIdTZ4agpEY0xsZE0wZUw0UnhjeVZUM3I0V3RKN2UveFJPMFlvd2tEQWJkV0ZBSy80K0tITEJuQkJEdDFPc2lEZFpJQTZBClFGby9USmkxYUdFNTkxK3dOYm9idkttcVUxOSswNzlLRmNFWEVYSGtjdHpNaWIwenlWVTVLWEhpdkFQbTBBU1IKT3U2TXJ0R2FpWkFCYzRkdkZ1Ylc1ZWlCQjNUSys3MHB5SzA0bmRxSGJHRWtOZXJwQ0w2Nm9YWlVVcDBUU1hEVQpLMVdwMUZYTDNlanF3YmN1aHFNbmVrbjBlZ2o3NXFwSFdIVDNPNG40WmdFQ2dZRUE0RTVWTVNKNmVCYWh2MnlpCmxsRzN0a2dFN1hYWXdCVWZoNU1VcXh0S0VnQWxBeWtwQUx2bWZsQVNYUWJtTkV6bytWTjlTUU5YZ1JvQWJsZXIKM0NHSSsyZUQvSTc4V28zb2NZQ0tyVGQwZS9FOUJGV2poRFNJMGVDaGhNcWFCTTFYLzQySS93RVRFVVYyWk5pUgpWK21GeGtQcHd0dGUxT3FxM04rbGN5VkdFbkVDZ1lFQTFLK1JGMmFyc3FuU0N4U3lwYU41VDV2a1ZLSWtaRnJ5CnBENlN3SDV5UjVtbE9KOGREMjI5dkI2ajNmK2NlcFJ6bW9BOUdMUGdaSmhzbnUvUlFqYk16REZBbVlEYzRvZzUKSzZYQUJnOVM3b3BYbXJkTThyZm54T2VLUlYzT3NWMStsenptZUhsT1RBTkpmeVZvc2F0L0NLNnhoSnUyS0o1TApZWnhtQkxBNm5hOENnWUVBaFd0U2xTVlMvM2RHd3B3Vm9aLzl6SGpPSllqQllvK3Q3M0IzRE1md3FRQlpBNlpKCjgxdlE0RFUwbHd6eGhRNXlUVXR4N0NvR3RJNEl6NWxxYWtld09RbjdvaEJTM25JbVhzejhyOGVhaTlhVVdxMnQKMDRlRUVvS3cwRkhLaHl5MU9SYXc5QzFwY0E2SE83anR5d0xtUldaRDkxbVE4TWljMVVCYUkwRjZpcUVDZ1lBTQpFMS9RalZMSVZSNEk1UWJ6b3FGN3BLVkZMT09XRXhmZHZYUEZuQ2hPNm1sWUdxaWl2SjllTS9zbjJxQiswVGp6CkY3N2dUUzQ3Wi9BYTRoRG1pb2Y4Ty91bis0b1BEcDc0WEhQWHBEMFlNQ0NqTnk4V1JOelM4RGFJazdmdG1CcGMKNmVkSUJkTXRPNjZMbW9za00xR0dJNjBPazJ5M1I2Mk9BRHhHbmQ3bUh3S0JnUURWWFVJeWx5TUMxQjlZZEtpKwpSaVJPYVJRQmFiUnNXcEprcnI1NjN4b0NYL3lqekRIQXpvM3NHZUtiMFJ0YzRERy9ydjIyRWR6dnVtd3YwV25TCko1VkpxY0RXMjViNHRycGRmcG95N3pXaGdpQWdkb2xOa24yZEw3YVJnanZNZUIrUFIrZjF4VS83bFZ5Zy9DanQKUlFrUVNLbndIRGdVNUxjNEhnUTFGeTJDemc9PQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg=="
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: portfolio-code-config

  # Exemple: inclure le contenu du fichier index.html ou autres fichiers code si tu veux passer en ConfigMap.
  # Sinon on utilise un volume hostPath ou autre selon ton mode. Ici, on suppose que le code est dans un volume.
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: portfolio-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      app: portfolio
  template:
    metadata:
      labels:
        app: portfolio
    spec:
      containers:
      - name: portfolio-container
        image: lidobel3/portfolio
        ports:
        - containerPort: 443
        volumeMounts:
        - name: code-volume
          mountPath: /usr/share/nginx/html  # chemin typique o√π ton serveur web cherche le code
        - name: portfolio-tls-secret
          mountPath: /etc/nginx/ssl/
          readOnly: true
      volumes:
      - name: code-volume
        configMap:
          name: portfolio-code-config
      - name: tls-volume
        secret:
          secretName: portfolio-tls-secret
      - name: tls-certs
        secret:
          secretName: portfolio-tls-secret
          items:
            - key: tls.crt
              path: lidobel.ovh.crt
            - key: tls.key
              path: lidobel.ovh.pem
---
apiVersion: v1
kind: Service
metadata:
  name: portfolio-service
spec:
  selector:
    app: portfolio
  ports:
  - protocol: TCP
    port: 443
    targetPort: 443
  type: LoadBalancer  # ou NodePort selon ton cluster
